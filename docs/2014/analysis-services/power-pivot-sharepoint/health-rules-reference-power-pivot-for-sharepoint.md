---
title: Guida di riferimento alle regole di integrità (PowerPivot per SharePoint) | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 47ae04ce-7b9d-49c2-8dbc-bafcb73d4603
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: bae8efeda0a82873498af93b0b79061f6135fd0c
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/27/2020
ms.locfileid: "72797604"
---
# <a name="health-rules-reference-powerpivot-for-sharepoint"></a>Guida di riferimento alle regole di integrità (PowerPivot per SharePoint)
  In questo argomento di riferimento vengono descritte le regole di analisi dell'integrità di SharePoint aggiunte da un'installazione di PowerPivot per SharePoint. Queste regole vengono utilizzate per segnalare problemi relativi a integrità del server, disponibilità o configurazione di un'applicazione del servizio [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] o dell'istanza di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] associata.  
  
 Nella tabella seguente vengono elencate le regole nell'ordine in cui sono visualizzate nella pagina Definizioni regole analizzatore dell'integrità in Amministrazione centrale di SharePoint. Le regole configurabili sono quelle per cui è possibile modificare le soglie in corrispondenza delle quali viene attivata la regola. Per ulteriori informazioni, vedere [regole di integrità di PowerPivot-Configure](configure-power-pivot-health-rules.md). Con l'indicazione Ripristino automatico si segnala la presenza di un rimedio predefinito che è possibile selezionare dalla pagina dei report sui problemi per risolvere il problema.  
  
||  
|-|  
|**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013 &#124; SharePoint 2010|  
  
 **Nota** [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installa diversi set di regole di analisi dell'integrità per versioni differenti di SharePoint. Vedere la colonna "Version" nella tabella seguente oppure è possibile eseguire il comando di Windows PowerShell seguente per visualizzare le regole installate.  
  
```powershell
Get-SPHealthAnalysisRule | Select name, enabled, summary | Where {$_.summary -like "*power*"}  | Format-Table -Property * -AutoSize | Out-Default  
```  
  
|Regola|Configurabile|Ripristino automatico|Versione|Descrizione|  
|----------|------------------|-----------------|-------------|-----------------|  
|PowerPivot: Il provider OLE DB di Analysis Services non è installato nel computer.|No|No|SharePoint 2010|Il provider OLE DB per Analysis Services non è installato nel server o la versione installata è errata. Questa regola viene visualizzata quando la farm di SharePoint include istanze di Excel Services su server applicazioni che non dispongono di PowerPivot per SharePoint. La regola avvisa che il provider OLE DB di Analysis Services utilizzato da Excel Services per la connessione ai dati PowerPivot non è installato. Per risolvere il problema, installare il provider OLE DB su ciascun server Excel Services in cui non è installato il provider OLE DB di Analysis Services. È possibile scaricare e installare il provider OLE DB di Analysis Services dall'Area download Microsoft. Per altre informazioni, vedere [Installazione del provider OLE DB di Analysis Services nei server di SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).|  
|PowerPivot: Le impostazioni del Registro di sistema per Microsoft.AnalysisServices.ChannelTransport.dll non sono valide dopo l'installazione della versione del provider MSOLAP per SQL Server 2008 R2 nel computer.|No|Sì|SharePoint 2010|Si tratta di un problema di configurazione del server. È probabile che ChannelTransport.dll non sia registrato nell'assembly globale. Eseguire il ripristino automatico per questa regola per registrare il file con estensione dll in ogni server che dispone di un'installazione di PowerPivot per SharePoint. In alternativa, è possibile eseguire regasm.exe manualmente per registrare il file. Se il servizio timer di SharePoint non è in esecuzione come amministratore locale, potrebbe essere richiesta la registrazione manuale. Il mancato aggiornamento delle impostazioni del Registro di sistema ha come conseguenza un rallentamento delle comunicazioni server tra Excel Services e il servizio di sistema PowerPivot e può comportare errori di connessione in determinate configurazioni di sicurezza.|  
|PowerPivot: L'applicazione del servizio PowerPivot non dispone dell'autorizzazione per completare l'operazione.|No|No|SharePoint 2010|Questa regola controlla se l'identità dell'applicazione del servizio PowerPivot è proprietaria del database dell'applicazione server di PowerPivot e dispone di autorizzazioni amministrative sull'istanza di SQL Server Analysis Services locale. Queste autorizzazioni vengono concesse automaticamente durante l'installazione e la distribuzione, tuttavia, se questo passaggio non viene completato, verrà generata questa regola di integrità.|  
|PowerPivot: L'identità dell'applicazione di servizio PowerPivot non può essere un membro del gruppo di amministratori locali.|No|No|SharePoint 2010|Si tratta di una procedura consigliata che consente di migliorare la sicurezza complessiva della distribuzione. Se è stata configurata l'applicazione del servizio PowerPivot per l'esecuzione in un account che appartiene al gruppo amministratori locale, è necessario impostare l'account del servizio su uno non appartenente a tale gruppo. Si consiglia di utilizzare un account dedicato con meno privilegi per ogni servizio. In questo modo, viene fornito l'isolamento del servizio ed è più facile controllare gli account di accesso. Per ulteriori informazioni sulla modifica dell'account del servizio, vedere [configurare gli account del servizio PowerPivot](configure-power-pivot-service-accounts.md).|  
|PowerPivot: l'istanza di Analysis Services è in esecuzione in modalità tabulare, ma l'impostazione di configurazione che specifica questa modalità è disabilitata.|No|No|SharePoint 2010|Questa regola verifica se nell'istanza di SQL Server Analysis Services in un'installazione di PowerPivot per SharePoint la proprietà server `DeploymentMode` è impostata su 1. Se la proprietà è impostata su un altro valore o il servizio timer di SharePoint che esegue il controllo della regola non dispone delle autorizzazioni per aprire il file, questa regola avrà esito negativo. Per altre informazioni sulla proprietà DeploymentMode, vedere [Determinare la modalità server di un'istanza di Analysis Services](../instances/determine-the-server-mode-of-an-analysis-services-instance.md).|  
|PowerPivot: Processo timer di aggiornamento dati PowerPivot disabilitato.|No|No|SharePoint 2013<br /><br /> SharePoint 2010|Controllare le impostazioni del processo timer per verificare che tale processo sia abilitato. Se non si utilizza la funzionalità dell'aggiornamento dati PowerPivot, è possibile ignorare questa regola. Per ulteriori informazioni, vedere [aggiornamento dati PowerPivot con SharePoint 2010](../powerpivot-data-refresh-with-sharepoint-2010.md).|  
|PowerPivot: Le informazioni sull'account di servizio di SQL Server Analysis Services (PowerPivot) gestite da Gestione configurazione SQL Server sono diverse da quelle gestite da Amministrazione centrale SharePoint.|No|No|SharePoint 2010|Questa regola controlla se le informazioni sull'account del servizio in Gestione configurazione SQL Server sono identiche alle informazioni sull'account gestito in Amministrazione centrale per la stessa istanza di Analysis Services. Se gli account sono diversi, viene aggiunta una voce al report relativo al problema e alla soluzione in modo da poter modificare le informazioni sull'account del servizio in Gestione configurazione SQL Server impostandole sull'account specificato in Amministrazione centrale. Gestione configurazione SQL Server non è uno strumento supportato per la modifica di nome utente o password di un account del servizio in un'installazione di PowerPivot per SharePoint. L'utilizzo di Amministrazione centrale consente di utilizzare la funzionalità degli account gestiti in SharePoint. Ancora più importante, se la farm include più server PowerPivot per SharePoint, la presenza di impostazioni dell'account del servizio incoerenti può causare l'interruzione delle operazioni di elaborazione e query nel server che dispone di informazioni errate sul servizio.<br /><br /> Su un solo server, le cartelle di lavoro di PowerPivot funzioneranno temporaneamente quando si attiva questa regola, ma si consiglia di correggere il problema appena possibile. Le autorizzazioni di database e file system vengono aggiornate utilizzando le informazioni dell'account specificate in Amministrazione centrale.|  
|PowerPivot: la soluzione farm distribuita non è aggiornata.|No|Sì|SharePoint 2010|Un'installazione di PowerPivot per SharePoint utilizza una soluzione a livello di farm e una soluzione a livello di applicazione Web per installare le funzionalità. Questa regola indica che la soluzione della farm non è aggiornata rispetto alla versione o al server o forse alla soluzione Web. Più probabilmente, si tratta di un problema relativo alla distribuzione del server. Per risolvere questo problema, considerare l'esecuzione del programma di installazione di SQL Server per ripristinare una delle installazioni di PowerPivot per SharePoint nella farm. Per ulteriori informazioni sulle soluzioni in un'installazione di PowerPivot per SharePoint, vedere [distribuire soluzioni PowerPivot in SharePoint](deploy-power-pivot-solutions-to-sharepoint.md).|  
|PowerPivot: Utilizzo complessivo della CPU troppo elevato.|Sì|No|SharePoint 2010|Questa regola consente di segnalare l'utilizzo della CPU a livello di sistema. L'utilizzo complessivo della CPU viene monitorato in quanto utilizzato dal servizio di sistema PowerPivot per misurare l'integrità del server, per il bilanciamento del carico basato su integrità fra più server PowerPivot per SharePoint in una farm. Considerare l'aggiunta di un altro server applicazioni alla farm e lo spostamento delle applicazioni che richiedono un utilizzo intenso della CPU in quel server.|  
|PowerPivot: Analysis Services non dispone di risorse di CPU sufficienti per eseguire le operazioni richieste.|Sì|No|SharePoint 2010|La quantità di risorse di CPU disponibile per il processo di Analysis Services (msmdsrv.exe) non è sufficiente per il livello di attività su questo server. Considerare l'aggiunta di un altro server PowerPivot per SharePoint alla farm. Per ulteriori informazioni, vedere [elenco di controllo per la distribuzione: scalabilità orizzontale mediante l'aggiunta di server PowerPivot a una farm di SharePoint 2010](../../sql-server/install/deployment-checklist-scale-out-adding-powerpivot-servers-sharepoint-2010-farm.md).|  
|PowerPivot: Analysis Services non dispone di memoria sufficiente per eseguire le operazioni richieste.|No|No|SharePoint 2010|Questa regola viene attivata quando è rimasto solo il 5% di memoria disponibile per Analysis Services. Un'istanza di SQL Server Analysis Services in un server applicazioni SharePoint deve disporre sempre di una piccola quantità di memoria di riserva inutilizzata. Poiché il server è associato alla memoria per la maggior parte delle operazioni, funziona meglio se non viene eseguito fino al limite massimo.<br /><br /> Per impostazione predefinita, vengono generati avvisi relativi alla memoria insufficiente quando la memoria disponibile raggiunge il 5%. È possibile impostare un valore più alto o più basso modificando le impostazioni nell'istanza di Analysis Services. Per ulteriori informazioni, vedere [regole di integrità di PowerPivot-Configure](configure-power-pivot-health-rules.md).<br /><br /> Il 5% di memoria inutilizzata viene calcolato come percentuale della memoria allocata ad Analysis Services. Se, ad esempio, si dispone di 200 GB di memoria totale e per Analysis Services ne viene allocato l'80% (o 160 GB), il 5% di memoria inutilizzata corrisponde al 5% di 160 GB (o 8 GB).|  
|PowerPivot: Il numero elevato di connessioni indica che devono essere distribuiti più server per gestire il carico corrente.|Sì|No|SharePoint 2010|Per impostazione predefinita, questa regola di analisi dell'integrità viene attivata quando il numero di connessioni utente distinte è superiore a 100. Questo valore predefinito è arbitrario (non è basato sulle specifiche hardware del server o sull'attività utente), pertanto è possibile aumentare o diminuire il valore a seconda della capacità del server e dell'attività utente nell'ambiente. Per ulteriori informazioni, vedere [regole di integrità di PowerPivot-Configure](configure-power-pivot-health-rules.md).|  
|PowerPivot: Il rapporto tra eventi di caricamento e connessioni è troppo elevato.|Sì|No|SharePoint 2013<br /><br /> SharePoint 2010|Per impostazione predefinita, questa regola di analisi dell'integrità viene attivata quando la percentuale di eventi di caricamento rispetto agli eventi di connessione supera il 50% dell'intero periodo di raccolta dei dati (per impostazione predefinita 4 ore). Un rapporto così alto indica un numero molto elevato di connessioni a cartelle di lavoro univoche o impostazioni di riduzione della cache troppo aggressive (per cui le cartelle di lavoro vengono rapidamente scaricate e rimosse dal sistema, mentre le richieste per tali dati sono ancora attive). Per evitare falsi positivi, devono essere presenti almeno 20 connessioni ogni periodo di 4 ore prima di poter calcolare il rapporto. È possibile basare questa regola di analisi dell'integrità su un rapporto diverso. Per ulteriori informazioni, vedere [regole di integrità di PowerPivot-Configure](configure-power-pivot-health-rules.md). Per altre informazioni sulla configurazione della cache, vedere [configurare l'utilizzo dello spazio su disco &#40;PowerPivot per SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot: Sono stati trovati più file minidump nella directory log, indicando un arresto anomalo del programma.|No|No|SharePoint 2013<br /><br /> SharePoint 2010|I file di minidump vengono generati durante un arresto anomalo del programma per acquisire informazioni sullo stato dell'applicazione del servizio PowerPivot prima del blocco. Queste informazioni possono essere inviate a Microsoft e utilizzate per la risoluzione dei problemi. Questa regola viene attivata quando vengono rilevati file con estensione dmp nel server. La regola fornisce un collegamento al file reperibile nella cartella \OLAP\Log dell'istanza di PowerPivot per SharePoint. Si noti che non è possibile utilizzare un editor di testo per visualizzare il contenuto del file. La visualizzazione di un file di minidump richiede il download e l'installazione di uno strumento di debug separato. Per altre informazioni, vedere [Strumenti di debug per Windows](/windows-hardware/drivers/debugger/).|  
|PowerPivot: Lo spazio su disco non è sufficiente nell'unità in cui i dati PowerPivot vengono memorizzati nella cache.|Sì|No|SharePoint 2010|Per impostazione predefinita, questa regola di integrità viene attivata quando lo spazio su disco è minore del 5% sull'unità disco in cui si trova la cartella di backup. Per ulteriori informazioni sull'impostazione di questa percentuale, vedere [regole di integrità di PowerPivot-Configure](configure-power-pivot-health-rules.md). Per ulteriori informazioni sull'utilizzo del disco, vedere [configurare l'utilizzo dello spazio su disco &#40;PowerPivot per SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot: I dati di utilizzo vengono aggiornati alla frequenza prevista.|Sì|No|SharePoint 2013<br /><br /> SharePoint 2010|In PowerPivot per SharePoint viene utilizzato il sistema di raccolta dati di utilizzo incorporato per raccogliere la metrica relativa alle connessioni, all'aggiornamento dati e ai tempi di risposta alle query. I dati di utilizzo vengono archiviati nel database dell'applicazione del servizio PowerPivot che, a sua volta, aggiorna una cartella di lavoro di PowerPivot (PowerPivot Management Data.xlsx) che fornisce dati ai report in Dashboard di gestione PowerPivot. Questa regola indica che i dati di utilizzo non vengono spostati nel file PowerPivot Management Data.xlsx con frequenza sufficiente. Il timestamp nel file con estensione xlsx viene utilizzato dalla regola come prova dell'aggiornamento del file. Se sono presenti altri problemi nel sistema di raccolta dei dati di utilizzo che minano l'accuratezza dei dati, non verranno rilevati da questa regola. Per risolvere questo errore, controllare i processi timer per verificare che siano in esecuzione. Per altre informazioni sulla raccolta dei dati di utilizzo, vedere [configurare la raccolta dati di utilizzo per &#40;PowerPivot per SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|PowerPivot: l'account del processo MidTier deve disporre dell'autorizzazione ' Full Read ' per tutti i applicazioni SPWebApplications associati.|No|Sì|SharePoint 2013<br /><br /> SharePoint 2010|L'identità dell'applicazione del servizio PowerPivot deve disporre delle autorizzazioni di **lettura complete** per accedere ai database del contenuto di SharePoint per conto di utenti che dispongono di autorizzazioni di sola visualizzazione per un documento. Per determinare quale account viene utilizzato come identità dell'applicazione del servizio PowerPivot, aprire la pagina **Configura account di servizio** in Amministrazione centrale. Molto probabilmente, l'applicazione del servizio è in esecuzione nel pool di applicazioni del servizio **Sistema di servizi Web di SharePoint** o in un pool di applicazioni dedicato. Anche se questa regola fornisce un'opzione di correzione automatica, si otterranno risultati migliori se si concedono manualmente le autorizzazioni eseguendo le operazioni seguenti:<br /><br /> 1) In Amministrazione centrale fare clic su **Gestisci applicazioni Web**.<br /><br /> 2) Selezionare un sito Web e quindi fare clic su **Criteri utenti**.<br /><br /> 3) Fare clic su **Aggiungi utenti**.<br /><br /> 4) Selezionare (Tutte le aree) e fare clic su **Avanti**.<br /><br /> 5) in utenti immettere l'identità dell'applicazione del servizio PowerPivot, quindi fare clic sulla casella di controllo **lettura completa** . Fare clic su **Fine**.<br /><br /> 7) Verificare la correzione. In Monitoraggio scegliere **Controlla definizioni regole**. Trovare e aprire la regola PowerPivot. Fare clic su **Esegui adesso**. Tornare a **Controlla problemi e soluzioni** per verificare che la regola sia scomparsa.|  
|PowerPivot: il Servizio di accesso secondario (seclogon) è disabilitato|No|No|SharePoint 2013<br /><br /> SharePoint 2010|Servizio di accesso secondario viene utilizzato per generare immagini di anteprima delle cartelle di lavoro di PowerPivot nella Raccolta PowerPivot. Per impostazione predefinita, il Servizio di accesso secondario è impostato sull'avvio manuale. Se il servizio è disabilitato, la generazione delle immagini di anteprima non riesce. Inoltre, i log ULS contengono l'errore seguente: "l'errore 1058 può avere come origine la causa del fatto che il servizio di Windows" accesso secondario "è disabilitato".<br /><br /> Per verificare la configurazione del servizio, usare l'applicazione console Servizi per individuare il Servizio di accesso secondario e modificare il **Tipo di avvio** su **Manuale**. Se il servizio non può essere abilitato, è possibile che i criteri di gruppo siano impostati per disabilitarlo. Rivolgersi all'amministratore per verificare questa ipotesi.<br /><br /> Dopo che il servizio è stato abilitato, immagini di anteprima o snapshot vengono aggiornate nel tempo. Facoltativamente, è possibile forzare l'aggiornamento riavviando il servizio, quindi aprendo e salvando di nuovo le pagine delle proprietà di un rapporto specifico. Per ulteriori informazioni, vedere [la pagina relativa alla modalità di utilizzo della raccolta PowerPivot](https://go.microsoft.com/fwlink/?LinkId=246462).|  
|PowerPivot: ADOMD.NET non è installato in un front-end Web configurato per l'amministrazione centrale|No|No|SharePoint 2013<br /><br /> SharePoint 2010|ADOMD.NET è una libreria client di Analysis Services che supporta la connessione a un database Analysis Services. In una distribuzione di PowerPivot per SharePoint, ADOMD.NET fornisce l'accesso ai report incorporati nel dashboard di gestione PowerPivot in Amministrazione centrale. I report incorporati sono di fatto cartelle di lavoro di PowerPivot contenenti dati Analysis Services incorporati. Il dashboard di gestione utilizza ADOMD.NET per inviare una richiesta di connessione al server che carica i dati contenuti nella cartella di lavoro.<br /><br /> Nelle topologie che includono Amministrazione centrale in esecuzione su un server front-end Web autonomo, è necessario installare ADOMD.NET manualmente per visualizzare questi report nel dashboard di gestione. Per altre informazioni, vedere [Installare ADOMD.NET in server front-end Web in cui viene eseguita Amministrazione centrale](../../sql-server/install/install-adomd-net-on-web-front-end-servers-running-central-administration.md).|  
